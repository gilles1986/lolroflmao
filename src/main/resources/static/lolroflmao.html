<!DOCTYPE html>
<html>
<head>
  <title></title>
  <script src="http://cdn.sockjs.org/sockjs-0.3.min.js"></script>
  <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
  <script>
    $(function() {
      var canvasElem = $("#canvas").get(0);
      canvas = canvasElem.getContext("2d");



      charset = new CharacterSet("img/chars4.png");
      charset.onLoad = function() {

        gilles = new Hero("Gilles");


      };


    });

    function CharacterSet(url) {

      var drawing = new Image();
      drawing.src = url;

      this.set = drawing;

      this.onLoad = function() {};

      drawing.onload = function() {
        I.onLoad(I);
      };

      var I = this;
    }

    function Hero(name) {

      this.name = name;
      this.direction = "down";
      this.location = {
        "x" : 0,
        "y" : 0
      };

      var heroPicCoords = {
        "x" : "",
        "y" : ""
      };

      this.getHeroPicCoords = function() {
        return heroPicCoords;
      };

      var charsPerLine = 4;
      var charLines = 2;
      var charsize = 32;

      var getRandomCharacter = function() {
        heroPicCoords.x = Math.round(Math.random() * (charsPerLine-1));
        heroPicCoords.y = Math.round(Math.random() * (charLines-1));

      }


      var directionToNumber = function(dir) {
        switch(dir) {
          case "up":
            return 3;
          case "right" :
            return 2;
          case "down" :
            return 0;
          case "left" :
            return 1;
        }
      };

      this.draw = function() {
        // x cord +1 because of middle Graphic

        var xclip = (((heroPicCoords.x * 3)+ 1) * charsize);
        var yclip = ((heroPicCoords.y * 4)*charsize)+(directionToNumber(I.direction)* charsize);

        console.debug(xclip, yclip);

        canvas.drawImage(charset.set,
            xclip,
            yclip,
            charsize, charsize,
            I.location.x,
            I.location.y,
            charsize, charsize);
      };

      this.update = function() {

      };



      var I = this;

      getRandomCharacter();


    }






  </script>
</head>
<body>
   <canvas id="canvas"></canvas>
</body>
</html>